<dfinance-frontend-main-header pageName="Sales Quotation" *ngIf="!isMaximized"></dfinance-frontend-main-header>
<dfinance-frontend-loader [loadingFlag]="isLoading" *ngIf="!isMaximized"></dfinance-frontend-loader>

<div class="row content-wrapper" (keydown)="onBodyKeydown($event)">
    <div class="left-section" #scrollableDivLeft [class.overlay-disabled]="!isInputDisabled"
        [class.hide-left-section]="!showLeftSection || isMaximized">
        <div #overlay [class.overlay]="!isInputDisabled" [style.display]="isInputDisabled ? 'none' : 'block'">
            <p translate>Disabled</p>
        </div>
        <div class="col-md-12 mb-3">
            <input #leftsearch type="text" placeholder="Search Here" class="form-control" (keyup)="filterSales($event)"
                style="width:100%;margin-bottom: 3px;" />
            <div class="add-details-toggle">
                <span>Additional Details</span>
                <div class="toggle-switch" [class.active]="istoggleActive" (click)="toggleActive()">
                    <div class="toggle-circle" [class.active]="istoggleActive"></div>
                </div>

            </div>
            <ngx-datatable class="material container striped" [rows]="allSalesListEstimate" [columnMode]="'flex'"
                [headerHeight]="40" [rowHeight]="40" [scrollbarV]="true" (activate)="onClickSalesEstimate($event)"
                [limit]="10" [selected]="selectedleftrow" [selectionType]="SelectionType.single"
                (select)='onSelectLeftTable($event)' [footerHeight]="0">
                <ngx-datatable-column name="VNo" [flexGrow]="2">
                    <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row?.TransactionNo }}
                        <div class="toggle-list-data" *ngIf="istoggleActive">{{row?.AccountName}}</div>
                    </ng-template>
                </ngx-datatable-column>

                <ngx-datatable-column name="VDate" [flexGrow]="2">
                    <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row?.Date | date: 'dd/MM/yyyy' }}
                        <div class="toggle-list-data" *ngIf="istoggleActive">{{row?.Amount}}</div>
                    </ng-template>
                </ngx-datatable-column>

            </ngx-datatable>
        </div>
    </div>
    <div class="left-toggle-section" (click)="toggleLeftSection()" *ngIf="!isMaximized">
        <span>
            <i *ngIf="showLeftSection" class="large material-icons">chevron_left</i>
            <i *ngIf="!showLeftSection" class="large material-icons">chevron_right</i>
        </span>
    </div>

    <div class="right-section-container" [class.full-width-right-section]="!showLeftSection"
        [class.full-width-screen]="isMaximized">

        <div class="top-control-bar flex-wrapper">
            <div #btngroup class="btn-group form-topbar" role="group" aria-label="Item Master">
                <button type="button" class="btn btn-outline-secondary" (click)="onClickNewSaleEstimate()"
                    [disabled]="isNewBtnDisabled" [class.top-button-active]="selectedSalesId == 0" translate>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14">
                        <path
                            d="M1.75 12.25V1.75H6.41667V2.91667H2.91667V11.0833H11.0833V7.58333H12.25V12.25H1.75ZM9.33333 6.41667V4.66667H7.58333V3.5H9.33333V1.75H10.5V3.5H12.25V4.66667H10.5V6.41667H9.33333Z" />
                    </svg>New</button>
                <button type="button" class="btn btn-outline-secondary" (click)="onClickSaveSalesEstimate()"
                    [disabled]="isSaveBtnDisabled || isSalesCancelled" translate>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14">
                        <path
                            d="M4.08333 11.0833V7.58333H9.91667V11.0833H11.0833V4.56633L9.43367 2.91667H2.91667V11.0833H4.08333ZM2.33333 1.75H9.91667L12.25 4.08333V11.6667C12.25 11.8214 12.1885 11.9697 12.0791 12.0791C11.9697 12.1885 11.8214 12.25 11.6667 12.25H2.33333C2.17862 12.25 2.03025 12.1885 1.92085 12.0791C1.81146 11.9697 1.75 11.8214 1.75 11.6667V2.33333C1.75 2.17862 1.81146 2.03025 1.92085 1.92085C2.03025 1.81146 2.17862 1.75 2.33333 1.75ZM5.25 8.75V11.0833H8.75V8.75H5.25Z" />
                    </svg>Save</button>
                <button type="button" class="btn btn-outline-secondary" (click)="onClickEditSalesEstimate()"
                    [disabled]="isEditBtnDisabled || isSalesCancelled"
                    [class.top-button-active]="selectedSalesId!=0 && !isSalesCancelled && !isInputDisabled" translate>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14">
                        <path
                            d="M11.375 7C11.375 6.88397 11.4211 6.77269 11.5031 6.69064C11.5852 6.60859 11.6965 6.5625 11.8125 6.5625C11.9285 6.5625 12.0398 6.60859 12.1219 6.69064C12.2039 6.77269 12.25 6.88397 12.25 7V11.8125C12.25 11.9285 12.2039 12.0398 12.1219 12.1219C12.0398 12.2039 11.9285 12.25 11.8125 12.25H2.1875C2.07147 12.25 1.96019 12.2039 1.87814 12.1219C1.79609 12.0398 1.75 11.9285 1.75 11.8125V2.1875C1.75 2.07147 1.79609 1.96019 1.87814 1.87814C1.96019 1.79609 2.07147 1.75 2.1875 1.75H7C7.11603 1.75 7.22731 1.79609 7.30936 1.87814C7.39141 1.96019 7.4375 2.07147 7.4375 2.1875C7.4375 2.30353 7.39141 2.41481 7.30936 2.49686C7.22731 2.57891 7.11603 2.625 7 2.625H2.625V11.375H11.375V7Z" />
                        <path
                            d="M6.42511 7.57751L7.14699 7.47425L11.5815 3.04063C11.6233 3.00027 11.6566 2.952 11.6795 2.89862C11.7025 2.84524 11.7145 2.78783 11.715 2.72974C11.7155 2.67165 11.7045 2.61404 11.6825 2.56028C11.6605 2.50651 11.628 2.45766 11.5869 2.41658C11.5458 2.3755 11.497 2.34302 11.4432 2.32102C11.3894 2.29902 11.3318 2.28795 11.2737 2.28846C11.2157 2.28896 11.1582 2.30103 11.1049 2.32396C11.0515 2.34689 11.0032 2.38022 10.9629 2.42201L6.52749 6.85563L6.42424 7.57751H6.42511ZM12.2001 1.80251C12.3221 1.92439 12.4188 2.06912 12.4848 2.22841C12.5509 2.38771 12.5848 2.55845 12.5848 2.73088C12.5848 2.90331 12.5509 3.07405 12.4848 3.23335C12.4188 3.39264 12.3221 3.53737 12.2001 3.65926L7.66324 8.19613C7.59633 8.26328 7.50943 8.30688 7.41561 8.32038L5.97186 8.52688C5.90458 8.53654 5.83597 8.53039 5.77147 8.50892C5.70698 8.48745 5.64837 8.45125 5.60031 8.40318C5.55224 8.35512 5.51604 8.29651 5.49457 8.23202C5.4731 8.16752 5.46695 8.09891 5.47661 8.03163L5.68311 6.58788C5.69637 6.49417 5.73966 6.40728 5.80649 6.34025L10.3442 1.80338C10.5904 1.55732 10.9241 1.4191 11.2722 1.4191C11.6202 1.4191 11.954 1.55732 12.2001 1.80338V1.80251Z" />
                    </svg>Edit</button>
                <div class="delete-btn-container">
                    <button type="button" class="btn btn-outline-secondary" (click)="toggleDeleteOptions()"
                        [disabled]="isDeleteBtnDisabled || isSalesCancelled"
                        [class.top-button-active]="selectedSalesId!=0 && showDeleteOptions">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14">
                            <path
                                d="M3.76538 11.0833L1.16663 13.125V2.33333C1.16663 2.17862 1.22808 2.03025 1.33748 1.92085C1.44688 1.81146 1.59525 1.75 1.74996 1.75H12.25C12.4047 1.75 12.553 1.81146 12.6624 1.92085C12.7718 2.03025 12.8333 2.17862 12.8333 2.33333V10.5C12.8333 10.6547 12.7718 10.8031 12.6624 10.9125C12.553 11.0219 12.4047 11.0833 12.25 11.0833H3.76538ZM2.33329 10.7246L3.36171 9.91667H11.6666V2.91667H2.33329V10.7246ZM7.82479 6.41667L9.26854 7.86042L8.44371 8.68525L6.99996 7.2415L5.55621 8.68583L4.73138 7.861L6.17513 6.41667L4.73079 4.97292L5.55563 4.14808L6.99996 5.59183L8.44371 4.14808L9.26854 4.97292L7.82479 6.41667Z" />
                        </svg>
                        Delete
                        <svg xmlns="http://www.w3.org/2000/svg" width="7" height="6" viewBox="0 0 7 6" fill="none">
                            <path
                                d="M3.5 5.15822L0 1.65822L0.816667 0.841553L3.5 3.52489L6.18333 0.841553L7 1.65822L3.5 5.15822Z" />
                        </svg>
                    </button>
                    <ul *ngIf="showDeleteOptions" class="btn-dropdown-menu">
                        <li><a href="#" (click)="onClickDeleteSalesEstimate($event)">Delete</a></li>
                        <li><a href="#" (click)="onClickCancelSalesEstimate($event)">Cancel</a></li>
                    </ul>
                </div>
                <button type="button" class="btn btn-outline-secondary" (click)="onClickPrint()"
                    [class.top-button-active]="selectedSalesId!=0 && isEditBtnDisabled" translate>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14">
                        <path
                            d="M3.49996 1.16666H10.5V4.66666H12.8333V10.5H10.5V12.8333H3.49996V10.5H1.16663V4.66666H3.49996V1.16666ZM4.66663 4.66666H9.33329V2.33332H4.66663V4.66666ZM3.49996 9.33332V6.99999H10.5V9.33332H11.6666V5.83332H2.33329V9.33332H3.49996ZM4.66663 8.16666V11.6667H9.33329V8.16666H4.66663Z" />
                    </svg>
                    Print</button>
                <button type="button" class="btn btn-outline-secondary" (click)="onClickPreview()"
                    [class.top-button-active]="selectedSalesId!=0 && isEditBtnDisabled" translate>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
                        <mask id="mask0_823_1892" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0"
                            width="14" height="14">
                            <rect width="14" height="14" fill="#D9D9D9" />
                        </mask>
                        <g mask="url(#mask0_823_1892)">
                            <path
                                d="M7.00016 9.33325C7.72933 9.33325 8.34912 9.07804 8.85954 8.56763C9.36995 8.05721 9.62516 7.43742 9.62516 6.70825C9.62516 5.97909 9.36995 5.35929 8.85954 4.84888C8.34912 4.33846 7.72933 4.08325 7.00016 4.08325C6.271 4.08325 5.6512 4.33846 5.14079 4.84888C4.63037 5.35929 4.37516 5.97909 4.37516 6.70825C4.37516 7.43742 4.63037 8.05721 5.14079 8.56763C5.6512 9.07804 6.271 9.33325 7.00016 9.33325ZM7.00016 8.28325C6.56266 8.28325 6.19079 8.13013 5.88454 7.82388C5.57829 7.51763 5.42516 7.14575 5.42516 6.70825C5.42516 6.27075 5.57829 5.89888 5.88454 5.59263C6.19079 5.28638 6.56266 5.13325 7.00016 5.13325C7.43766 5.13325 7.80954 5.28638 8.11579 5.59263C8.42204 5.89888 8.57516 6.27075 8.57516 6.70825C8.57516 7.14575 8.42204 7.51763 8.11579 7.82388C7.80954 8.13013 7.43766 8.28325 7.00016 8.28325ZM7.00016 11.0833C5.58072 11.0833 4.28766 10.6871 3.121 9.89471C1.95433 9.10235 1.1085 8.0402 0.583496 6.70825C1.1085 5.37631 1.95433 4.31415 3.121 3.52179C4.28766 2.72943 5.58072 2.33325 7.00016 2.33325C8.41961 2.33325 9.71266 2.72943 10.8793 3.52179C12.046 4.31415 12.8918 5.37631 13.4168 6.70825C12.8918 8.0402 12.046 9.10235 10.8793 9.89471C9.71266 10.6871 8.41961 11.0833 7.00016 11.0833ZM7.00016 9.91658C8.09877 9.91658 9.10745 9.62735 10.0262 9.04888C10.945 8.4704 11.6474 7.6902 12.1335 6.70825C11.6474 5.72631 10.945 4.9461 10.0262 4.36763C9.10745 3.78915 8.09877 3.49992 7.00016 3.49992C5.90155 3.49992 4.89287 3.78915 3.97412 4.36763C3.05537 4.9461 2.35294 5.72631 1.86683 6.70825C2.35294 7.6902 3.05537 8.4704 3.97412 9.04888C4.89287 9.62735 5.90155 9.91658 7.00016 9.91658Z" />
                        </g>
                    </svg>
                    Preview
                </button>
                <button type="button" class="btn btn-outline-secondary" (click)="onClickPreview()"
                    [class.top-button-active]="selectedSalesId!=0 && isEditBtnDisabled" translate>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
                        <mask id="mask0_823_1897" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0"
                            width="14" height="14">
                            <rect width="14" height="14" fill="#D9D9D9" />
                        </mask>
                        <g mask="url(#mask0_823_1897)">
                            <path
                                d="M2.33317 11.6666C2.01234 11.6666 1.73768 11.5523 1.50921 11.3239C1.28074 11.0954 1.1665 10.8208 1.1665 10.4999V3.49992C1.1665 3.17909 1.28074 2.90443 1.50921 2.67596C1.73768 2.44749 2.01234 2.33325 2.33317 2.33325H11.6665C11.9873 2.33325 12.262 2.44749 12.4905 2.67596C12.7189 2.90443 12.8332 3.17909 12.8332 3.49992V10.4999C12.8332 10.8208 12.7189 11.0954 12.4905 11.3239C12.262 11.5523 11.9873 11.6666 11.6665 11.6666H2.33317ZM6.99984 7.58325L2.33317 4.66659V10.4999H11.6665V4.66659L6.99984 7.58325ZM6.99984 6.41658L11.6665 3.49992H2.33317L6.99984 6.41658ZM2.33317 4.66659V3.49992V10.4999V4.66659Z" />
                        </g>
                    </svg>
                    Email
                </button>
                <button type="button" class="btn btn-outline-secondary" (click)="onClickPreview()"
                    [class.top-button-active]="selectedSalesId!=0 && isEditBtnDisabled" translate>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
                        <mask id="mask0_823_1902" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0"
                            width="14" height="14">
                            <rect width="14" height="14" fill="#D9D9D9" />
                        </mask>
                        <g mask="url(#mask0_823_1902)">
                            <path
                                d="M4.08333 9.91667H8.16667V8.75H4.08333V9.91667ZM4.08333 7.58333H9.91667V6.41667H4.08333V7.58333ZM4.08333 5.25H9.91667V4.08333H4.08333V5.25ZM2.91667 12.25C2.59583 12.25 2.32118 12.1358 2.09271 11.9073C1.86424 11.6788 1.75 11.4042 1.75 11.0833V2.91667C1.75 2.59583 1.86424 2.32118 2.09271 2.09271C2.32118 1.86424 2.59583 1.75 2.91667 1.75H11.0833C11.4042 1.75 11.6788 1.86424 11.9073 2.09271C12.1358 2.32118 12.25 2.59583 12.25 2.91667V11.0833C12.25 11.4042 12.1358 11.6788 11.9073 11.9073C11.6788 12.1358 11.4042 12.25 11.0833 12.25H2.91667ZM2.91667 11.0833H11.0833V2.91667H2.91667V11.0833Z" />
                        </g>
                    </svg>
                    Bills
                </button>
                <button type="button" class="btn btn-outline-secondary" (click)="onClickPreview()"
                    [class.top-button-active]="selectedSalesId!=0 && isEditBtnDisabled" translate>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
                        <mask id="mask0_823_1907" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0"
                            width="14" height="14">
                            <rect width="14" height="14" fill="#D9D9D9" />
                        </mask>
                        <g mask="url(#mask0_823_1907)">
                            <path
                                d="M10.5002 9.18758C10.5002 10.1987 10.1453 11.0591 9.43558 11.7688C8.72586 12.4786 7.86544 12.8334 6.85433 12.8334C5.84322 12.8334 4.9828 12.4786 4.27308 11.7688C3.56336 11.0591 3.2085 10.1987 3.2085 9.18758V3.79175C3.2085 3.06258 3.4637 2.44279 3.97412 1.93237C4.48454 1.42196 5.10433 1.16675 5.8335 1.16675C6.56266 1.16675 7.18245 1.42196 7.69287 1.93237C8.20329 2.44279 8.4585 3.06258 8.4585 3.79175V8.89592C8.4585 9.34314 8.30294 9.7223 7.99183 10.0334C7.68072 10.3445 7.30155 10.5001 6.85433 10.5001C6.40711 10.5001 6.02794 10.3445 5.71683 10.0334C5.40572 9.7223 5.25016 9.34314 5.25016 8.89592V3.50008H6.41683V8.89592C6.41683 9.0223 6.45815 9.12682 6.54079 9.20946C6.62343 9.2921 6.72794 9.33342 6.85433 9.33342C6.98072 9.33342 7.08523 9.2921 7.16787 9.20946C7.25051 9.12682 7.29183 9.0223 7.29183 8.89592V3.79175C7.28211 3.38341 7.1387 3.03828 6.86162 2.75633C6.58454 2.47439 6.24183 2.33341 5.8335 2.33341C5.42516 2.33341 5.08002 2.47439 4.79808 2.75633C4.51613 3.03828 4.37516 3.38341 4.37516 3.79175V9.18758C4.36544 9.87786 4.60363 10.4636 5.08975 10.9449C5.57586 11.4261 6.16405 11.6667 6.85433 11.6667C7.53488 11.6667 8.11336 11.4261 8.58975 10.9449C9.06613 10.4636 9.31405 9.87786 9.3335 9.18758V3.50008H10.5002V9.18758Z" />
                        </g>
                    </svg>
                    Attach
                </button>
                <button type="button" class="btn btn-outline-secondary" (click)="onClickPreview()"
                    [class.top-button-active]="selectedSalesId!=0 && isEditBtnDisabled" translate>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
                        <mask id="mask0_823_1912" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0"
                            width="14" height="14">
                            <rect width="14" height="14" fill="#D9D9D9" />
                        </mask>
                        <g mask="url(#mask0_823_1912)">
                            <path
                                d="M5.25 10.5001C4.92917 10.5001 4.65451 10.3858 4.42604 10.1574C4.19757 9.9289 4.08333 9.65425 4.08333 9.33342V2.33341C4.08333 2.01258 4.19757 1.73793 4.42604 1.50946C4.65451 1.28098 4.92917 1.16675 5.25 1.16675H10.5C10.8208 1.16675 11.0955 1.28098 11.324 1.50946C11.5524 1.73793 11.6667 2.01258 11.6667 2.33341V9.33342C11.6667 9.65425 11.5524 9.9289 11.324 10.1574C11.0955 10.3858 10.8208 10.5001 10.5 10.5001H5.25ZM5.25 9.33342H10.5V2.33341H5.25V9.33342ZM2.91667 12.8334C2.59583 12.8334 2.32118 12.7192 2.09271 12.4907C1.86424 12.2622 1.75 11.9876 1.75 11.6667V3.50008H2.91667V11.6667H9.33333V12.8334H2.91667Z" />
                        </g>
                    </svg>
                    Copy
                </button>
                <dfinance-frontend-gridandlabelsettings [pageId]="pageId"></dfinance-frontend-gridandlabelsettings>
                <button type="button" class="btn btn-outline-secondary" (click)="onClickPreview()"
                    [class.top-button-active]="selectedSalesId!=0 && isEditBtnDisabled" translate>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14">
                        <path
                            d="M1.1665 1.16675H12.8332V12.8334H1.1665V1.16675ZM2.33317 2.33341V11.6667H11.6665V2.33341H2.33317ZM6.99984 4.22925C6.75856 4.22919 6.5232 4.30393 6.32617 4.44319C6.12914 4.58245 5.98014 4.77937 5.89967 5.00683L5.70484 5.55691L4.60525 5.16841L4.7995 4.61833C4.91993 4.27682 5.11818 3.96801 5.37857 3.71634C5.63895 3.46467 5.95432 3.27705 6.29974 3.16831C6.64515 3.05956 7.01113 3.03269 7.36873 3.08981C7.72632 3.14694 8.06572 3.28648 8.36007 3.49742C8.65442 3.70836 8.89564 3.98489 9.06467 4.30516C9.23369 4.62542 9.32587 4.98062 9.33392 5.34266C9.34196 5.70469 9.26565 6.06364 9.11102 6.39109C8.9564 6.71855 8.72769 7.00553 8.443 7.22933C8.19159 7.42766 7.96642 7.61783 7.80367 7.81792C7.64384 8.01508 7.58317 8.17375 7.58317 8.31258V9.04175H6.4165V8.31258C6.4165 7.80683 6.644 7.395 6.89834 7.08175C7.15034 6.77258 7.4665 6.51358 7.72084 6.31291C7.91148 6.16296 8.05065 5.95732 8.11898 5.72459C8.18732 5.49187 8.18142 5.24363 8.1021 5.01441C8.02279 4.7852 7.874 4.5864 7.67645 4.44568C7.47889 4.30495 7.24239 4.2293 6.99984 4.22925ZM6.4165 9.62508H7.5855V10.7941H6.4165V9.62508Z" />
                    </svg>
                    Help
                </button>
                <button type="button" class="btn btn-outline-secondary" (click)="onClickPreview()"
                    [class.top-button-active]="selectedSalesId!=0 && isEditBtnDisabled" translate>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
                        <mask id="mask0_823_1927" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0"
                            width="14" height="14">
                            <rect width="14" height="14" fill="#D9D9D9" />
                        </mask>
                        <g mask="url(#mask0_823_1927)">
                            <path
                                d="M1.1665 11.9583V7.29158H5.83317V11.9583H1.1665ZM2.33317 10.7916H4.6665V8.45825H2.33317V10.7916ZM3.20817 5.83325L6.4165 0.583252L9.62484 5.83325H3.20817ZM5.279 4.66658H7.554L6.4165 2.82909L5.279 4.66658ZM12.5853 13.3874L11.0394 11.8416C10.8353 11.9777 10.6141 12.0798 10.3759 12.1478C10.1377 12.2159 9.88734 12.2499 9.62484 12.2499C8.89567 12.2499 8.27588 11.9947 7.76546 11.4843C7.25504 10.9739 6.99984 10.3541 6.99984 9.62492C6.99984 8.89575 7.25504 8.27596 7.76546 7.76554C8.27588 7.25513 8.89567 6.99992 9.62484 6.99992C10.354 6.99992 10.9738 7.25513 11.4842 7.76554C11.9946 8.27596 12.2498 8.89575 12.2498 9.62492C12.2498 9.8777 12.2158 10.1232 12.1478 10.3614C12.0797 10.5996 11.9825 10.8208 11.8561 11.0249L13.4019 12.5708L12.5853 13.3874ZM9.62484 11.0833C10.0332 11.0833 10.3783 10.9423 10.6603 10.6603C10.9422 10.3784 11.0832 10.0333 11.0832 9.62492C11.0832 9.21659 10.9422 8.87145 10.6603 8.5895C10.3783 8.30756 10.0332 8.16658 9.62484 8.16658C9.2165 8.16658 8.87136 8.30756 8.58942 8.5895C8.30748 8.87145 8.1665 9.21659 8.1665 9.62492C8.1665 10.0333 8.30748 10.3784 8.58942 10.6603C8.87136 10.9423 9.2165 11.0833 9.62484 11.0833Z" />
                        </g>
                    </svg>
                    Import Items
                </button>
                <button type="button" class="btn btn-outline-secondary" (click)="onClickPreview()"
                    [class.top-button-active]="selectedSalesId!=0 && isEditBtnDisabled" translate>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
                        <mask id="mask0_823_1933" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0"
                            width="14" height="14">
                            <rect width="14" height="14" fill="#D9D9D9" />
                        </mask>
                        <g mask="url(#mask0_823_1933)">
                            <path
                                d="M6.12484 4.08325C6.12484 3.76242 6.23907 3.48777 6.46755 3.25929C6.69602 3.03082 6.97067 2.91659 7.2915 2.91659C7.61234 2.91659 7.88699 3.03082 8.11546 3.25929C8.34393 3.48777 8.45817 3.76242 8.45817 4.08325C8.45817 4.40409 8.34393 4.67874 8.11546 4.90721C7.88699 5.13568 7.61234 5.24992 7.2915 5.24992C6.97067 5.24992 6.69602 5.13568 6.46755 4.90721C6.23907 4.67874 6.12484 4.40409 6.12484 4.08325ZM7.2915 13.9999L4.6665 11.3749L5.5415 10.2083L4.6665 9.04159L5.5415 7.802V7.11659C5.0165 6.80547 4.59359 6.38499 4.27275 5.85513C3.95192 5.32527 3.7915 4.73464 3.7915 4.08325C3.7915 3.11103 4.13178 2.28464 4.81234 1.60409C5.49289 0.92353 6.31928 0.583252 7.2915 0.583252C8.26373 0.583252 9.09011 0.92353 9.77067 1.60409C10.4512 2.28464 10.7915 3.11103 10.7915 4.08325C10.7915 4.73464 10.6311 5.32527 10.3103 5.85513C9.98942 6.38499 9.5665 6.80547 9.0415 7.11659V12.2499L7.2915 13.9999ZM4.95817 4.08325C4.95817 4.6277 5.12345 5.10652 5.454 5.51971C5.78456 5.93291 6.20261 6.20756 6.70817 6.34367V8.16659L6.11025 9.01242L6.99984 10.2083L6.19775 11.2437L7.2915 12.3374L7.87484 11.7541V6.34367C8.38039 6.20756 8.79845 5.93291 9.129 5.51971C9.45956 5.10652 9.62484 4.6277 9.62484 4.08325C9.62484 3.44159 9.39636 2.89228 8.93942 2.43534C8.48248 1.97839 7.93317 1.74992 7.2915 1.74992C6.64984 1.74992 6.10053 1.97839 5.64359 2.43534C5.18664 2.89228 4.95817 3.44159 4.95817 4.08325Z" />
                        </g>
                    </svg>
                    Keys
                    <svg xmlns="http://www.w3.org/2000/svg" width="7" height="6" viewBox="0 0 7 6" fill="none">
                        <path
                            d="M3.5 5.15822L0 1.65822L0.816667 0.841553L3.5 3.52489L6.18333 0.841553L7 1.65822L3.5 5.15822Z" />
                    </svg>
                </button>
                <button type="button" class="btn btn-outline-secondary" (click)="onClickPreview()"
                    [class.top-button-active]="selectedSalesId!=0 && isEditBtnDisabled" translate>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
                        <mask id="mask0_823_1942" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0"
                            width="14" height="14">
                            <rect width="14" height="14" fill="#D9D9D9" />
                        </mask>
                        <g mask="url(#mask0_823_1942)">
                            <path
                                d="M5.075 9.74167L4.25833 8.925L6.76667 6.41667H4.66667V5.25H8.75V9.33333H7.58333V7.23333L5.075 9.74167ZM11.0833 7V2.91667H7V1.75H12.25V7H11.0833ZM2.91667 12.25C2.59583 12.25 2.32118 12.1358 2.09271 11.9073C1.86424 11.6788 1.75 11.4042 1.75 11.0833V1.75H2.91667V11.0833H12.25V12.25H2.91667Z" />
                        </g>
                    </svg>
                    Export
                    <svg xmlns="http://www.w3.org/2000/svg" width="7" height="6" viewBox="0 0 7 6" fill="none">
                        <path
                            d="M3.5 5.15822L0 1.65822L0.816667 0.841553L3.5 3.52489L6.18333 0.841553L7 1.65822L3.5 5.15822Z" />
                    </svg>
                </button>

            </div>
            <div class="currency-section flex-wrapper">
                <div class="currency-box" *ngIf="multiCurrencySupport" translate>Currency</div>

                <select [disabled]="isInputDisabled" class="form-select" tabIndex="3"
                    (change)="onChangeCurrency($event)" [(ngModel)]="selectedCurrencyId">
                    <option *ngFor="let currency of currencyDropdown" [value]="currency?.currencyID">{{
                        currency?.abbreviation }}</option>
                </select>
                <input type="text" class="form-control" [(ngModel)]="currentCurrencyRate">
                <div class="flex-wrapper"><button class="btn" (click)="saveCurrencyRate()">
                        <img src="../../../assets/img/ri_save-line.svg" alt="icon">
                    </button></div>

            </div>
        </div>

        <div #scrollContainer class="right-section sales-quotation-section" (scroll)="onScroll($event)">
            <form [formGroup]="salesEstimateForm">
                <div class="top-bar" *ngIf="showTopBar" (click)="scrollToTop()">
                    <div class="top-bar-single">
                        <span>Voucher No - {{ salesEstimateForm.get('voucherno')?.value }}</span>
                    </div>
                    <div class="top-bar-single">
                        <span>Project - {{ updatedProject }}</span>
                    </div>
                    <div class="top-bar-single">
                        <span>Supplier - {{ updatedCustomer }}</span>
                    </div>
                    <div class="top-bar-single">
                        <span>Salesman - {{ updatedSalesman }}</span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="section-container">
                            <div class="section-content">
                                <div class="purchase-form-top-container">
                                    <div class="purchase-form-left">
                                        <div class="purchase-voucher-outer">
                                            <label for="voucherno" class="form-label">Voucher No</label>
                                            <input type="text" class="form-control" id="vouchername"
                                                formControlName="vouchername" tabindex="1">
                                            <input type="text" class="form-control" id="voucherno"
                                                formControlName="voucherno" tabindex="2">
                                        </div>
                                        <div class="project-section">
                                            <label for="project" class="form-label">Project</label>
                                            <dfinance-frontend-searchable-dropdown [fieldName]="'project'"
                                                [options]="projectData" [isdisabled]="isInputDisabled"
                                                [updatedOption]="updatedProject" [returnField]="projectreturnField"
                                                [dropdownFields]="projectKeys" [tabIndex]="6"
                                                (selectedOption)="onProjectSelected($event)"
                                                (keydown)="onFormKeyDown($event,7)"></dfinance-frontend-searchable-dropdown>
                                        </div>

                                        <div class="purchase-partyinvoice-outer">
                                            <label for="partyinvoiceno" class="form-label">Party Invoice No &
                                                Date</label>
                                            <input type="text" class="form-control" tabindex="10" id="partyinvoiceno"
                                                formControlName="partyinvoiceno" (change)="onChangePartyInvNo($event)"
                                                (keydown)="onFormKeyDown($event,11)">
                                            <div class="calendar-wrapper party-invoice-date-wrapper">
                                                <input class="form-control" formControlName="partyinvoicedate"
                                                    tabindex="11" matInput [matDatepicker]="pid"
                                                    (dateChange)="onChangePartyInvDate($event)"
                                                    (keydown)="onFormKeyDown($event,12)">
                                                <mat-datepicker-toggle matSuffix [for]="pid"></mat-datepicker-toggle>
                                                <mat-datepicker #pid></mat-datepicker>
                                            </div>
                                        </div>

                                    </div>

                                    <div class="purchase-form-right">
                                        <div class="purchase-form-right-top">
                                            <div class="top-section1">
                                                <div class="purchase-date-section">
                                                    <label for="purchasedate" class="form-label " translate>Date</label>
                                                    <div class="flex-wrapper purchase-date-wrapper calendar-wrapper">
                                                        <input class="form-control" formControlName="purchasedate"
                                                            matInput [matDatepicker]="prdt" tabindex="3"
                                                            (keydown)="onFormKeyDown($event,4)">
                                                        <mat-datepicker-toggle matSuffix
                                                            [for]="prdt"></mat-datepicker-toggle>
                                                        <mat-datepicker #prdt></mat-datepicker>
                                                    </div>
                                                </div>
                                                <div class="purchase-supplier-outer">
                                                    <label for="customer" class="form-label">Customer<span
                                                            class="required-asterisk">*</span></label>
                                                    <div class="supplier-btn-section">
                                                        <dfinance-frontend-searchable-dropdown [fieldName]="'customer'"
                                                            [options]="customerData" [isdisabled]="isInputDisabled"
                                                            [updatedOption]="updatedCustomer"
                                                            [returnField]="customerreturnField"
                                                            [dropdownFields]="customerKeys" [tabIndex]="7"
                                                            (selectedOption)="onCustomerSelected($event)"
                                                            [excludedKeys]="customerExcludekeys"
                                                            (focus)="fetchCustomer()"
                                                            (keydown)="onFormKeyDown($event,8)"></dfinance-frontend-searchable-dropdown>

                                                        <button type="button" class="btn btn-secondary"
                                                            ngbTooltip="Create" placement="top"
                                                            [disabled]="isInputDisabled" (click)="onClickCustomer()">
                                                            ...
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="top-section2">
                                                <div class="reference-section">
                                                    <label for="reference" class="form-label">Reference<span
                                                            class="required-asterisk">*</span></label>
                                                    <div class="reference-btn-section">
                                                        <input type="text" class="form-control" tabindex="4"
                                                            id="reference" formControlName="reference"
                                                            (keydown)="onFormKeyDown($event,5)">
                                                        <button type="button" class="btn btn-secondary"
                                                            ngbTooltip="Import" placement="top"
                                                            [disabled]="isInputDisabled"
                                                            (click)="openImportReferencePopup()">
                                                            ...
                                                        </button>
                                                        <div *ngIf="salesEstimateForm.get('reference')?.hasError('required')"
                                                            class="text-danger">
                                                            Reference is required.
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="salesman-section">
                                                    <label for="salesman" class="form-label">Sales Man</label>
                                                    <dfinance-frontend-searchable-dropdown [options]="salesmanData"
                                                        [fieldName]="'salesman'" [isdisabled]="isInputDisabled"
                                                        [updatedOption]="updatedSalesman" [returnField]="salesmanField"
                                                        [dropdownFields]="salesmanKeys" [tabIndex]="8"
                                                        (selectedOption)="onSalesmanSelected($event)"
                                                        (keydown)="onFormKeyDown($event,9)"></dfinance-frontend-searchable-dropdown>
                                                </div>
                                            </div>

                                            <div class="top-section3">
                                                <div class="warehouse-section">
                                                    <label for="warehouse" class="form-label">Warehouse</label>
                                                    <select id="warehouse" class="form-select" tabindex="5"
                                                        formControlName="warehouse" (change)="onChangeWarehouse()"
                                                        (keydown)="onFormKeyDown($event,6)">
                                                        <option *ngFor="let warehouse of warehouseData"
                                                            [value]="warehouse?.id">
                                                            {{ warehouse?.name }}</option>
                                                    </select>
                                                </div>
                                                <div class="vatno-section">
                                                    <label for="vatno" class="form-label">VAT No</label>
                                                    <input type="text" class="form-control" tabindex="9" id="vatno"
                                                        formControlName="vatno" (keydown)="onFormKeyDown($event,10)">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="purchase-form-right-bottom">
                                            <label for="description" class="form-label">Description</label>
                                            <input type="text" class="form-control" id="description"
                                                formControlName="description" tabindex="12"
                                                (keydown)="onFormKeyDown($event,-1)">
                                        </div>
                                    </div>

                                </div>



                            </div>
                            <div class="custom-mat-tab-container">
                                <mat-tab-group animationDuration="0ms" class="tab-item-additional-details"
                                    (selectedTabChange)="onPurchaseTabChange($event)">
                                    <mat-tab label="Item Details">
                                        <div class="table-container">
                                            <div class="table-wrapper" #tableWrapper>
                                                <div class="item-purchase-table item-main-table">
                                                    <div class="datatable-container">
                                                        <ngx-datatable #ngxTable class="material"
                                                            [rows]="tempItemFillDetails" columnMode="flex"
                                                            [headerHeight]="30" [footerHeight]="30" [rowHeight]="30"
                                                            [selected]="selected" [style.min-height.px]="tableHeight">
                                                            <ngx-datatable-column
                                                                *ngFor="let col of tablecolumns; let colIndex = index"
                                                                [name]="col.name" [flexGrow]="col.field === 'id' ? 1 : 4">
                                                                <ng-template let-row="row" let-rowIndex="rowIndex"
                                                                    ngx-datatable-cell-template>

                                                                    <!-- Code for Column ID -->
                                                                    <span *ngIf="col.field === 'id'  && rowIndex != tempItemFillDetails.length -1"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0"
                                                                        (click)="onClickIDColumn($event,rowIndex, colIndex)"
                                                                        [attr.data-column-name]="col.field"
                                                                        (keydown)="onKeyDown($event)"
                                                                        data-column-key-name="id">
                                                                        {{ rowIndex+1 }}
                                                                    </span>
                                                                    <!-- Code for Column Item Code -->
                                                                    <div (click)="validateItemGridEntry()"
                                                                        *ngIf="col.field === 'itemcode'">

                                                                        <span
                                                                            [ngClass]="{'selected-cell': isSelectedCell(rowIndex,colIndex)}"
                                                                            id="cell-{{rowIndex}}-{{colIndex}}"
                                                                            tabindex="0" #gridCell
                                                                            (click)="onClickSpan($event,rowIndex,colIndex)"
                                                                            *ngIf="col.field === 'itemcode' && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'itemcode') || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                            (keydown)="onKeyDown($event)"
                                                                            [attr.data-column-name]="col.field"
                                                                            (dblclick)="handleDoubleClick($event)"
                                                                            data-column-key-name="itemCode">{{row?.itemCode}}</span>

                                                                        <dfinance-frontend-searchable-dropdown
                                                                            fieldName="cell-{{rowIndex}}-{{colIndex}}itemcode"
                                                                            [options]="fillItemDataOptions"
                                                                            [isdisabled]="isInputDisabled"
                                                                            [updatedOption]="row?.itemCode"
                                                                            [returnField]="itemCodereturnField"
                                                                            [dropdownFields]="itemCodeKeys"
                                                                            [tabIndex]="10"
                                                                            [excludedKeys]="itemCodeExcludekeys"
                                                                            (selectedOption)="onItemCodeSelected($event, rowIndex)"
                                                                            [isEmitEvent]="!isPartySelected"
                                                                            (focusEvent)="validateItemGridEntry()"
                                                                            [isGridCell]="true"
                                                                            cellid="cell-{{rowIndex}}-{{colIndex}}"
                                                                            (click)="onClickInput($event,rowIndex,colIndex)"
                                                                            (emitKeyboardEvent)="onColumKeyDown($event)"
                                                                            *ngIf="enableInlineEditing && currentColumname == 'itemcode' && rowIndex == currentRowIndex"
                                                                            (keydown)="onKeyDown($event)"
                                                                            [attr.data-column-name]="col.field">
                                                                        </dfinance-frontend-searchable-dropdown>
                                                                    </div>

                                                                    <!-- Code for Column Item Name -->
                                                                    <span *ngIf="col.field === 'itemname'"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        [attr.data-column-name]="col.field"
                                                                        (dblclick)="navigateToItemPage(row?.itemId)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        data-column-key-name="itemName">
                                                                        {{ row?.itemName }}
                                                                    </span>

                                                                    <!-- Code for Column stockitem -->
                                                                    <span
                                                                        *ngIf="showStockItemField && gridColumns.includes('StockItem') && col.field === 'stockitem' && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'stockitem')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="stockItem">
                                                                        {{ row?.stockItem }}
                                                                    </span>

                                                                    <dfinance-frontend-searchable-dropdown
                                                                        fieldName="cell-{{rowIndex}}-{{colIndex}}stockitem"
                                                                        [options]="stockItemObj"
                                                                        [isdisabled]="isInputDisabled || !isPartySelected"
                                                                        [updatedOption]="row?.stockItem"
                                                                        [returnField]="stockItemreturnField"
                                                                        [dropdownFields]="stockItemKeys" [tabIndex]="10"
                                                                        (selectedOption)="onStockItemSelected($event,rowIndex)"
                                                                        [isGridCell]="true"
                                                                        cellid="cell-{{rowIndex}}-{{colIndex}}"
                                                                        (click)="onClickInput($event,rowIndex,colIndex)"
                                                                        (emitKeyboardEvent)="onColumKeyDown($event)"
                                                                        *ngIf="col.field === 'stockitem' && enableInlineEditing && currentColumname == 'stockitem' && rowIndex == currentRowIndex"
                                                                        (keydown)="onKeyDown($event)"
                                                                        [attr.data-column-name]="col.field">
                                                                    </dfinance-frontend-searchable-dropdown>


                                                                    <!-- Code for Column batchNo -->
                                                                    <span
                                                                        *ngIf="col.field === 'batchno' && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'batchno')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="batchNo">
                                                                        {{ row?.batchNo }}
                                                                    </span>

                                                                    <!-- <input type="text" class="form-control"
                                                                        *ngIf=" col.field === 'batchno' && enableInlineEditing && currentColumname == 'batchno'  && rowIndex == currentRowIndex"
                                                                        value="{{ row?.batchNo }}"
                                                                        [disabled]="isInputDisabled || !isPartySelected"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        (keydown)="onKeyDown($event)"
                                                                        (click)="onClickInput($event,rowIndex,colIndex)"
                                                                        [attr.data-column-name]="col.field"
                                                                        (input)="onChangeBatchNo(rowIndex, $event)"> -->
                                                                    <dfinance-frontend-searchable-dropdown
                                                                        [options]="row?.batchNoPopup"
                                                                        [isdisabled]="isInputDisabled || !isPartySelected"
                                                                        [updatedOption]="row?.batchNo"
                                                                        [returnField]="itemBatchNoreturnField"
                                                                        [dropdownFields]="itemBatchNoKeys"
                                                                        [tabIndex]="11"
                                                                        (selectedOption)="onItemBatchNoSelected($event,rowIndex)"
                                                                        [attr.data-column-name]="col.field"
                                                                        [isGridCell]="true"
                                                                        cellid="cell-{{rowIndex}}-{{colIndex}}"
                                                                        (click)="onClickInput($event,rowIndex,colIndex)"
                                                                        (emitKeyboardEvent)="onColumKeyDown($event)"
                                                                        *ngIf="col.field === 'batchno' && enableInlineEditing && currentColumname == 'batchno'  && rowIndex == currentRowIndex"
                                                                        (keydown)="onKeyDown($event)"></dfinance-frontend-searchable-dropdown>

                                                                    <!-- Code for Column Unit -->
                                                                    <span
                                                                        *ngIf="col.field === 'unit' && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'unit')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        [attr.data-column-name]="col.field" tabindex="0"
                                                                        [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="unit">
                                                                        {{ row?.unit?.unit }}
                                                                    </span>

                                                                    <dfinance-frontend-searchable-dropdown
                                                                        fieldName="cell-{{rowIndex}}-{{colIndex}}unit"
                                                                        [options]="row?.unitsPopup"
                                                                        [isdisabled]="isInputDisabled || !isPartySelected"
                                                                        [updatedOption]="row?.unit?.unit"
                                                                        [returnField]="itemUnitreturnField"
                                                                        [dropdownFields]="itemUnitKeys" [tabIndex]="11"
                                                                        (selectedOption)="onItemUnitSelected($event,rowIndex)"
                                                                        [attr.data-column-name]="col.field"
                                                                        [isGridCell]="true"
                                                                        cellid="cell-{{rowIndex}}-{{colIndex}}"
                                                                        (click)="onClickInput($event,rowIndex,colIndex)"
                                                                        (emitKeyboardEvent)="onColumKeyDown($event)"
                                                                        *ngIf="col.field === 'unit' && enableInlineEditing && currentColumname == 'unit'  && rowIndex == currentRowIndex"
                                                                        (keydown)="onKeyDown($event)"></dfinance-frontend-searchable-dropdown>

                                                                    <!-- Code for Column Qty -->
                                                                    <span
                                                                        *ngIf="col.field === 'qty' && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'qty')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="qty">
                                                                        {{ row?.qty }}
                                                                    </span>

                                                                    <input
                                                                        *ngIf=" col.field === 'qty' && enableInlineEditing && currentColumname == 'qty' && rowIndex == currentRowIndex"
                                                                        type="text" class="form-control"
                                                                        [ngbTooltip]="tipContent" placement="bottom"
                                                                        [disabled]="isInputDisabled || !isPartySelected"
                                                                        value="{{ row?.qty }}" name="qty"
                                                                        [attr.data-column-name]="col.field"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        (change)="onChangeQuantity(rowIndex, $event)"
                                                                        appNumberFormat (keydown)="onKeyDown($event)"
                                                                        (click)="onClickInput($event,rowIndex,colIndex)"
                                                                        (mouseleave)="onMouseLeaveQty(rowIndex,$event)">

                                                                    <!-- Code for Column focqty -->
                                                                    <span
                                                                        *ngIf="col.field === 'focqty' && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'focqty')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        [attr.data-column-name]="col.field"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="focQty">
                                                                        {{ row?.focQty }}
                                                                    </span>

                                                                    <input
                                                                        *ngIf=" col.field === 'focqty' && enableInlineEditing && currentColumname == 'focqty'  && rowIndex == currentRowIndex"
                                                                        type="text" class="form-control"
                                                                        [disabled]="isInputDisabled || !isPartySelected"
                                                                        value="{{ row?.focQty }}" name="focqty"
                                                                        (input)="onChangeFocQuantity(rowIndex, $event)"
                                                                        appNumberFormat (keydown)="onKeyDown($event)"
                                                                        [attr.data-column-name]="col.field"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        (click)="onClickInput($event,rowIndex,colIndex)">

                                                                    <!-- Code for Column pricecategory -->
                                                                    <span
                                                                        *ngIf="col.field === 'pricecategory' && gridColumns.includes('PriceCategory') && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'pricecategory')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="priceCategory">
                                                                        {{ row?.priceCategory?.name }}
                                                                    </span>
                                                                    <dfinance-frontend-searchable-dropdown
                                                                        fieldName="cell-{{rowIndex}}-{{colIndex}}pricecategory"
                                                                        [options]="row?.priceCategoryOptions"
                                                                        [isdisabled]="isInputDisabled || !isPartySelected"
                                                                        [updatedOption]="row?.priceCategory?.name"
                                                                        [returnField]="pricecategoryreturnField"
                                                                        [dropdownFields]="pricecategoryKeys"
                                                                        [tabIndex]="10"
                                                                        [attr.data-column-name]="col.field"
                                                                        (selectedOption)="onPriceCategorySelected($event,rowIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        [isGridCell]="true"
                                                                        cellid="cell-{{rowIndex}}-{{colIndex}}"
                                                                        (click)="onClickInput($event,rowIndex,colIndex)"
                                                                        (emitKeyboardEvent)="onColumKeyDown($event)"
                                                                        *ngIf="col.field === 'pricecategory' && gridColumns.includes('PriceCategory') && enableInlineEditing && currentColumname == 'pricecategory' && rowIndex == currentRowIndex">
                                                                    </dfinance-frontend-searchable-dropdown>

                                                                    <!-- Code for Column rate -->
                                                                    <span
                                                                        *ngIf="col.field === 'rate' && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'rate')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="rate">
                                                                        {{ row?.rate }}
                                                                    </span>

                                                                    <input type="text" class="form-control"
                                                                        [disabled]="isInputDisabled || !isPartySelected"
                                                                        value="{{ row?.rate }}" name="rate"
                                                                        (input)="onChangeRate(rowIndex, $event)"
                                                                        *ngIf=" col.field === 'rate' && enableInlineEditing && currentColumname == 'rate'  && rowIndex == currentRowIndex"
                                                                        (blur)="onRateBlur(rowIndex,$event)"
                                                                        appNumberFormat (keydown)="onKeyDown($event)"
                                                                        [attr.data-column-name]="col.field"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0"
                                                                        (click)="onClickInput($event,rowIndex, colIndex)">

                                                                    <!-- Code for Column ratewithtax -->
                                                                    <span
                                                                        *ngIf="col.field === 'ratewithtax' && (showRateWithTax == 1) && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'ratewithtax')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="ratewithtax">
                                                                        {{ row?.printedMRP !== 0 ? row?.printedMRP : ''
                                                                        }}
                                                                    </span>

                                                                    <input type="text" class="form-control"
                                                                        [disabled]="isInputDisabled || !isPartySelected"
                                                                        value="{{ row?.printedMRP }}" name="ratewithtax"
                                                                        (input)="onChangeRateWithTax(rowIndex, $event)"
                                                                        *ngIf=" col.field === 'ratewithtax' && (showRateWithTax == 1) && enableInlineEditing && currentColumname == 'ratewithtax'  && rowIndex == currentRowIndex"
                                                                        appNumberFormat (keydown)="onKeyDown($event)"
                                                                        [attr.data-column-name]="col.field"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0"
                                                                        (click)="onClickInput($event,rowIndex, colIndex)">

                                                                    <!-- Code for Column grossamount -->
                                                                    <span
                                                                        *ngIf="col.field === 'grossamount' && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'grossamount')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="grossAmt">
                                                                        {{ row?.grossAmt }}
                                                                    </span>

                                                                    <input type="text" class="form-control"
                                                                        [disabled]="isInputDisabled || !isgrossAmountEditable || !isPartySelected"
                                                                        value="{{ row?.grossAmt }}" name="grossamount"
                                                                        (blur)="onChangeGrossAmount(rowIndex, $event)"
                                                                        appNumberFormat
                                                                        *ngIf=" col.field === 'grossamount' && enableInlineEditing && currentColumname == 'grossamount'  && rowIndex == currentRowIndex"
                                                                        (keydown)="onKeyDown($event)"
                                                                        [attr.data-column-name]="col.field"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0"
                                                                        (click)="onClickInput($event,rowIndex, colIndex)">

                                                                    <!-- Code for Column discperc -->
                                                                    <span
                                                                        *ngIf="col.field === 'discperc' && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'discperc')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="discountPerc">
                                                                        {{ row?.discountPerc }}
                                                                    </span>

                                                                    <input
                                                                        *ngIf=" col.field === 'discperc' && enableInlineEditing && currentColumname == 'discperc'  && rowIndex == currentRowIndex"
                                                                        type="text" class="form-control"
                                                                        [disabled]="isInputDisabled || !isPartySelected"
                                                                        value="{{ row?.discountPerc }}"
                                                                        name="discpercent"
                                                                        (blur)="onChangeDiscountPercent(rowIndex, $event)"
                                                                        appNumberFormat (keydown)="onKeyDown($event)"
                                                                        [attr.data-column-name]="col.field"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0"
                                                                        (click)="onClickInput($event,rowIndex, colIndex)">

                                                                    <!-- Code for Column discount -->
                                                                    <span
                                                                        *ngIf="col.field === 'discount' && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'discount')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="discount">
                                                                        {{ row?.discount }}
                                                                    </span>

                                                                    <input type="text" class="form-control"
                                                                        [disabled]="isInputDisabled || !isPartySelected"
                                                                        value="{{ row?.discount }}" name="discount"
                                                                        (input)="onInputDiscount(rowIndex, $event)"
                                                                        (blur)="onChangeDiscount(rowIndex, $event)"
                                                                        appNumberFormat
                                                                        [attr.data-column-name]="col.field"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0"
                                                                        (click)="onClickInput($event,rowIndex, colIndex)"
                                                                        *ngIf=" col.field === 'discount' && enableInlineEditing && currentColumname == 'discount'  && rowIndex == currentRowIndex">

                                                                    <!-- Code for Column amount -->
                                                                    <span
                                                                        *ngIf="col.field === 'amount' && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'amount')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="amount">
                                                                        {{ row?.amount }}
                                                                    </span>

                                                                    <!-- Code for Column taxperc -->
                                                                    <span
                                                                        *ngIf="col.field === 'taxperc' && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'taxperc')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="taxPerc">
                                                                        {{ row?.taxPerc }}
                                                                    </span>

                                                                    <!-- Code for Column taxvalue -->
                                                                    <span
                                                                        *ngIf="col.field === 'taxvalue' && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'taxvalue')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="taxValue">
                                                                        {{ row?.taxValue }}
                                                                    </span>

                                                                    <!-- Code for Column sizemasterid -->
                                                                    <span
                                                                        *ngIf="col.field === 'sizemasterid' && gridColumns.includes('SizeMasterID') && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'sizemasterid')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="sizeMaster">
                                                                        {{ row?.sizeMaster?.name }}
                                                                    </span>

                                                                    <dfinance-frontend-searchable-dropdown
                                                                        fieldName="cell-{{rowIndex}}-{{colIndex}}sizemasterid"
                                                                        [options]="sizeMasterObj"
                                                                        [isdisabled]="isInputDisabled || !isPartySelected"
                                                                        [updatedOption]="row?.sizeMaster?.name"
                                                                        [returnField]="sizemasterreturnField"
                                                                        [dropdownFields]="sizemasterKeys"
                                                                        [tabIndex]="10"
                                                                        (selectedOption)="onSizemasterSelected($event,rowIndex)"
                                                                        [attr.data-column-name]="col.field"
                                                                        [isGridCell]="true"
                                                                        cellid="cell-{{rowIndex}}-{{colIndex}}"
                                                                        (click)="onClickInput($event,rowIndex,colIndex)"
                                                                        (emitKeyboardEvent)="onColumKeyDown($event)"
                                                                        *ngIf="col.field === 'sizemasterid' && gridColumns.includes('SizeMasterID') && enableInlineEditing && 
                                                                    currentColumname == 'sizemasterid'  && rowIndex == currentRowIndex"
                                                                        (keydown)="onKeyDown($event)">
                                                                    </dfinance-frontend-searchable-dropdown>

                                                                    <!-- Code for Column total -->
                                                                    <span
                                                                        *ngIf="col.field === 'total'&& (!enableInlineEditing || (enableInlineEditing && currentColumname != 'total')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="total">
                                                                        {{ row?.total }}
                                                                    </span>

                                                                    <!-- Code for Column expirydate -->
                                                                    <span
                                                                        *ngIf="col.field === 'expirydate' && (!enableInlineEditing || (enableInlineEditing && currentColumname != 'expirydate')  || (enableInlineEditing && rowIndex != currentRowIndex))"
                                                                        [ngClass]="{'selected-cell': isSelectedCell(rowIndex, colIndex)}"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0" [attr.data-column-name]="col.field"
                                                                        (click)="onClickSpan($event,rowIndex, colIndex)"
                                                                        (keydown)="onKeyDown($event)"
                                                                        (dblclick)="handleDoubleClick($event)"
                                                                        data-column-key-name="expiryDate">
                                                                        {{ row?.expiryDate | date: 'dd/MM/yyyy' }}
                                                                    </span>

                                                                    <input
                                                                        *ngIf=" col.field === 'expirydate' && enableInlineEditing && currentColumname == 'expirydate' && rowIndex == currentRowIndex"
                                                                        type="text" class="form-control"
                                                                        [disabled]="isInputDisabled || !isPartySelected"
                                                                        value="{{ row?.expiryDate | date: 'dd/MM/yyyy' }}"
                                                                        name="expirydate" (blur)="dateValidator($event)"
                                                                        (input)="formatDate($event)"
                                                                        [attr.data-column-name]="col.field"
                                                                        (keydown)="onKeyDown($event)"
                                                                        id="cell-{{rowIndex}}-{{colIndex}}" #gridCell
                                                                        tabindex="0"
                                                                        (click)="onClickInput($event,rowIndex, colIndex)">
                                                                </ng-template>
                                                            </ngx-datatable-column>
                                                            <ngx-datatable-footer></ngx-datatable-footer>


                                                        </ngx-datatable>

                                                    </div>
                                                </div>
                                            </div>

                                            <div class="table-summary" #tableSummary>
                                                <div></div>
                                                <div class="summary-cell" *ngFor="let col of tablecolumns" #summaryCell>
                                                    <ng-container *ngIf="col.field === 'itemcode'">
                                                        <input type="text" placeholder="Search Here"
                                                            class="form-control" (keyup)="updateFilter($event)"
                                                            style="width: 100%" />
                                                    </ng-container>

                                                    <ng-container *ngIf="(col.field == 'id') || (col.field == 'itemname') || (col.field == 'stockitem') 
                                                    || (col.field == 'batchno') || (col.field == 'unit') || (col.field == 'pricecategory')
                                                    || (col.field == 'rate') || (col.field == 'discperc') || (col.field == 'taxperc')
                                                    || (col.field == 'sizemasterid' || (col.field == 'expirydate'))">
                                                        <div></div>
                                                    </ng-container>

                                                    <ng-container *ngIf="col.field == 'qty'">
                                                        <!-- <input type="text" name="qtytotal" class="form-control" readonly
                                                            value="{{qtyTotal}}"> -->
                                                        <span>{{qtyTotal}}</span>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.field == 'focqty'">
                                                        <!-- <input type="text" name="focqtytotal" class="form-control" readonly
                                                            value="{{FOCQtyTotal}}"> -->
                                                        <span>{{FOCQtyTotal}}</span>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.field == 'grossamount'">
                                                        <!-- <input type="text" name="grossamounttotal" class="form-control" readonly
                                                            value="{{grossAmountTotal}}"> -->

                                                        <span>{{grossAmountTotal}}</span>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.field == 'discount'">
                                                        <!-- <input type="text" name="discounttotal" class="form-control" readonly
                                                            value="{{discountTotal}}"> -->

                                                        <span>{{discountTotal}}</span>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.field == 'amount'">
                                                        <!-- <input type="text" name="amounttotal" class="form-control" readonly
                                                            value="{{amountTotal}}"> -->

                                                        <span>{{amountTotal}}</span>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.field == 'taxvalue'">
                                                        <!-- <input type="text" name="taxvaluetotal" class="form-control"
                                                            value="{{taxTotal}}" readonly> -->

                                                        <span>{{taxTotal}}</span>
                                                    </ng-container>
                                                    <ng-container *ngIf="col.field == 'total'">
                                                        <!-- <input type="text" name="total" class="form-control" readonly
                                                            value="{{gridItemTotal}}"> -->

                                                        <span>{{gridItemTotal}}</span>
                                                    </ng-container>
                                                </div>
                                            </div>
                                        </div>

                                    </mat-tab>
                                    <mat-tab label="Additional Details">
                                        <div>

                                            <!-- Additional details content starts here -->
                                            <p>General</p>
                                            <hr>
                                            <form [formGroup]="additionalDetailsForm">
                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Party Invoice No. & Date">Party
                                                            Invoice No. &
                                                            Date</label>
                                                    </div>
                                                    <div class="col-md-4 flex-wrapper">
                                                        <input type="text" formControlName="invoiceno"
                                                            class="form-control">

                                                        <div class="flex-wrapper calendar-wrapper invoice-date">
                                                            <input class="form-control" formControlName="invoicedate"
                                                                matInput [matDatepicker]="indt">
                                                            <mat-datepicker-toggle matSuffix
                                                                [for]="indt"></mat-datepicker-toggle>
                                                            <mat-datepicker #indt></mat-datepicker>
                                                        </div>

                                                    </div>


                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Order No. & Date">Order No. &
                                                            Date</label>
                                                    </div>
                                                    <div class="col-md-4 flex-wrapper">
                                                        <input type="text" formControlName="orderno"
                                                            class="form-control">
                                                        <div class="flex-wrapper calendar-wrapper order-date">
                                                            <input class="form-control" formControlName="orderdate"
                                                                matInput [matDatepicker]="ordt">
                                                            <mat-datepicker-toggle matSuffix
                                                                [for]="ordt"></mat-datepicker-toggle>
                                                            <mat-datepicker #ordt></mat-datepicker>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Party Name & Address">Party Name
                                                            &
                                                            Address</label>
                                                    </div>
                                                    <div class="col-md-10">
                                                        <input type="text" formControlName="partyaddress"
                                                            class="form-control">
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Expiry Date">Expiry Date</label>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="flex-wrapper calendar-wrapper expiry-date">
                                                            <input class="form-control" formControlName="expirydate"
                                                                matInput [matDatepicker]="expdt">
                                                            <mat-datepicker-toggle matSuffix
                                                                [for]="expdt"></mat-datepicker-toggle>
                                                            <mat-datepicker #expdt></mat-datepicker>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-2">
                                                        <label class="form-label"
                                                            for="Transportation Type">Transportation
                                                            Type</label>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <select class="form-select"
                                                            formControlName="transportationtype">
                                                            <option value="">Select</option>
                                                            <option *ngFor="let trType of transportationTypeArr"
                                                                [value]="trType?.id">{{ trType?.value }}</option>
                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-6"></div>
                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Credit Period">Credit
                                                            Period</label>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <input type="text" class="form-control"
                                                            formControlName="creditperiod">
                                                    </div>
                                                </div>

                                                <hr>
                                                <p>Sales</p>
                                                <hr>

                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Salesman">Salesman</label>
                                                    </div>
                                                    <div class="col-md-4 ">
                                                        <dfinance-frontend-searchable-dropdown [options]="salesmanData"
                                                            [fieldName]="'salesman'" [isdisabled]="isInputDisabled"
                                                            [updatedOption]="updatedSalesman"
                                                            [returnField]="salesmanField"
                                                            [dropdownFields]="salesmanKeys" [tabIndex]="8"
                                                            (selectedOption)="onSalesmanSelected($event)"
                                                            (keydown)="onFormKeyDown($event,9)"></dfinance-frontend-searchable-dropdown>
                                                    </div>

                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Sales Area">Sales Area</label>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <select class="form-select" formControlName="salesarea">
                                                            <option value="">Select</option>
                                                            <option *ngFor="let area of salesmanAreaArr"
                                                                [value]="area?.id">{{ area?.name }}</option>
                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Staff Incentive">staff
                                                            Incentive</label>
                                                    </div>
                                                    <div class="col-md-2">
                                                        <input type="text" formControlName="staffincentive"
                                                            class="form-control">
                                                    </div>
                                                    <div class="col-md-2 flex-wrapper">
                                                        <span>(%)</span>
                                                        <input type="text" formControlName="staffincentiveperc"
                                                            class="form-control">
                                                    </div>
                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Mobile Number">Mobile
                                                            Number</label>
                                                    </div>
                                                    <div class="col-md-2">
                                                        <input type="text" formControlName="mobilenumber"
                                                            class="form-control" appTelephoneInput>
                                                    </div>
                                                </div>

                                                <hr>
                                                <p>Delivery Details</p>
                                                <hr>

                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Vehicle No.">Vehicle No.</label>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <dfinance-frontend-searchable-dropdown [options]="vehicleNoData"
                                                            [updatedOption]="updatedVehicleNo"
                                                            [returnField]="vehicleNoReturnField"
                                                            [dropdownFields]="vehicleNoKeys" [tabIndex]="4"
                                                            (selectedOption)="onVehicleNoSelected($event)"
                                                            [isdisabled]="isInputDisabled">
                                                        </dfinance-frontend-searchable-dropdown>
                                                    </div>
                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Attention">Attention</label>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <input type="text" class="form-control"
                                                            formControlName="attention">
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <label class="form-label"
                                                            for="Delivery Note No. & Date">Delivery Note No. &
                                                            Date</label>
                                                    </div>
                                                    <div class="col-md-4 flex-wrapper">
                                                        <input type="text" formControlName="deliverynote"
                                                            class="form-control">
                                                        <div class="flex-wrapper calendar-wrapper delivery-date">
                                                            <input class="form-control" formControlName="deliverydate"
                                                                matInput [matDatepicker]="deldt">
                                                            <mat-datepicker-toggle matSuffix
                                                                [for]="deldt"></mat-datepicker-toggle>
                                                            <mat-datepicker #deldt></mat-datepicker>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Dispatch No. & Date">Dispatch No.
                                                            &
                                                            Date</label>
                                                    </div>
                                                    <div class="col-md-4 flex-wrapper">
                                                        <input type="text" formControlName="dispatchno"
                                                            class="form-control">
                                                        <div class="flex-wrapper calendar-wrapper dispatch-date">
                                                            <input class="form-control" formControlName="dispatchdate"
                                                                matInput [matDatepicker]="disdt">
                                                            <mat-datepicker-toggle matSuffix
                                                                [for]="disdt"></mat-datepicker-toggle>
                                                            <mat-datepicker #disdt></mat-datepicker>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Party Name">Party Name</label>
                                                    </div>
                                                    <div class="col-md-10">
                                                        <input type="text" formControlName="partyname"
                                                            class="form-control">
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Address Line 1">Address Line
                                                            1</label>
                                                    </div>
                                                    <div class="col-md-10">
                                                        <input type="text" formControlName="addressline1"
                                                            class="form-control">
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Address Line 2">Address Line
                                                            2</label>
                                                    </div>
                                                    <div class="col-md-10">
                                                        <input type="text" formControlName="addressline2"
                                                            class="form-control">
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <label class="form-label" for="Delivery Location">Delivery
                                                            Location</label>
                                                    </div>
                                                    <div class="col-md-10">
                                                        <dfinance-frontend-searchable-dropdown
                                                            [options]="deliveryLocationData"
                                                            [updatedOption]="updatedDeliveryLocation"
                                                            [returnField]="deliveryLocationReturnField"
                                                            [dropdownFields]="deliveryLocationKeys" [tabIndex]="4"
                                                            (selectedOption)="onDeliveryLocationSelected($event)"
                                                            [isdisabled]="isInputDisabled">
                                                        </dfinance-frontend-searchable-dropdown>
                                                    </div>
                                                </div>
                                                <p>Terms of Delivery</p>
                                                <hr>
                                                <textarea formControlName="terms" class="form-control"></textarea>
                                            </form>
                                            <!-- Additional details content end here -->
                                        </div>
                                    </mat-tab>
                                </mat-tab-group>
                                <div class="purchase-options-outer">
                                    <div class="gross-amount-approve-options">
                                        <div class="barcode-btn" [class.disabled-block]="!selectedPartyId"
                                            (click)="openBarcodePopup();">
                                            <span>BR</span>
                                        </div>
                                        <div class="gross-amount-edit-options" *ngIf="grossAmountEditSettings">
                                            <label for="grossamountedit" class="form-label">Gross Amount Edit</label>
                                            <label class="custom-checkbox">
                                                <input type="checkbox" class="form-check-input"
                                                    [checked]="isgrossAmountEditable" [disabled]="isInputDisabled"
                                                    (change)="changeGrossAmountEditable($event)">
                                                <span class="checkmark"></span>
                                            </label>
                                        </div>
                                        <div class="approve-outer">
                                            <label for="approve" class="form-label">Approve</label>
                                            <label class="custom-checkbox">
                                                <input type="checkbox" class="form-check-input"
                                                    [disabled]="isInputDisabled">
                                                <span class="checkmark"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="party-balance-text">Party Balance : 0.00</div>
                                </div>
                            </div>

                            <div class="section-separator"></div>

                            <div class="section-content" >
                                <div class="terms-discount-section">
                                    <div class="terms-outer">
                                        <label for="terms" class="form-label terms-label">Terms</label>
                                        <input type="text" class="form-control terms-input" id="terms"
                                            formControlName="terms" tabindex="13" (keydown)="onFormKeyDown($event,14)">
                                    </div>
                                    <div class="discount-outer">
                                        <label for="commoditydiscount" class="form-label disc-label">Total Disc
                                            Comm.Disc</label>
                                        <label for="%" class="form-label">%</label>
                                        <input type="text" class="form-control" id="totaldiscpercent"
                                            formControlName="totaldiscpercent"
                                            (change)="onChangeCommonDiscountPercent($event)" tabindex="14"
                                            (keydown)="onFormKeyDown($event,15)" appNumberFormat>
                                        <label for="discountamount" class="form-label amt-label">Amt</label>
                                        <input type="text" id="discountamount" formControlName="discountamount"
                                            (change)="onChangeCommonDiscountAmount($event)" tabindex="15"
                                            (keydown)="onFormKeyDown($event,16)" appNumberFormat>
                                        <button type="button" class="disc-amt-apl" [disabled]="true" ngbTooltip="Import"
                                            placement="top">
                                            Apl
                                        </button>
                                    </div>
                                    <!-- <a href="#" *ngIf="itemExpiryManagement" class="btn purchase-item-details"
                                        (click)="openItemDetails($event)">Item Details</a> -->

                                </div>
                                <div style="display: flex;">
                                    <!-- <div class="col-md-1">
                                        <input type="text" class="form-control" id="amount" appNumberFormat>
                                    </div> -->
                                    <div class="tax-roundoff-container" style="margin-right: 0px;">
                                        <div class="tax-roundoff-section">
                                            <label for="roundoff" class="form-label">Round Off</label>
                                            <div class="">
                                                <div class="flex-wrapper">
                                                    <input type="text" class="form-control" id="roundoff"
                                                        formControlName="roundoff" tabindex="16"
                                                        (keydown)="onFormKeyDown($event,17)" appNumberFormat>
                                                    <button type="button" class="btn btn-secondary"
                                                        (click)="onClickRoundOff()">
                                                        ...
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="tax-roundoff-section">
                                            <label for="tax" class="form-label ">Tax</label>
                                            <div class="flex-wrapper">
                                                <input type="text" class="form-control" id="tax" formControlName="tax"
                                                    value="{{taxTotal}}" appNumberFormat>
                                                <button type="button" class="btn btn-secondary" (click)="openTaxPopup()"
                                                    ngbTooltip="Create" placement="top" [disabled]="isInputDisabled">
                                                    ...
                                                </button>
                                            </div>
                                        </div>
                                        <div class="tax-roundoff-section">
                                            <label for="addcharges" class="form-label">Add. Charges</label>
                                            <div class="flex-wrapper">
                                                <input type="text" class="form-control" id="addcharges"
                                                    formControlName="addcharges">
                                                <button type="button" class="btn btn-secondary"
                                                    (click)="openAdditionalChargesPopup()" ngbTooltip="Create"
                                                    placement="top" [disabled]="isInputDisabled">
                                                    ...
                                                </button>
                                            </div>
                                        </div>

                                        <div class="tax-roundoff-section">
                                            <label for="netamount" class="form-label ">Net Amount</label>
                                            <input type="text" class="form-control" id="netamount"
                                                formControlName="netamount" readonly appNumberFormat>
                                        </div>

                                    </div>
                                    <div class="grandtotal-section">
                                        <label for="grandtotal" class="form-label ">Grand Total
                                        </label>
                                        <input type="text" class="form-control" id="grandtotal"
                                            formControlName="grandtotal" readonly>
                                    </div>

                                </div>


                            </div>
                        </div>
                    </div>
                </div>



            </form>
        </div>

        <!-- Bottom fixed bar inside the scrollable div -->
        <div class="bottom-bar" *ngIf="showBottomBar" (click)="scrollToBottom()">
            <div class="bottom-bar-single">
                <span>Net amount- {{ salesEstimateForm.get('netamount')?.value }}</span>
            </div>
            <div class="bottom-bar-single">
                <span>Balance- {{ salesEstimateForm.get('balance')?.value }}</span>
            </div>
            <div class="bottom-bar-single">
                <span>Grand total- {{grandTotal}}</span>
            </div>
        </div>

        <!--  user role popup -->
        <dfinance-frontend-import-reference-popup *ngIf="showImportReferencePopup" [referenceData]="referenceFillData"
            [voucherTypes]="voucherTypeData" [partyData]="partyData" (savereference)="saveReferenceData($event)"
            (close)="closeImportReferencePopup()"></dfinance-frontend-import-reference-popup>

        <dfinance-frontend-item-price-popup *ngIf="showPricePopup" [itemUnitData]="currentItemUnitDetails"
            [itemID]="currentItemId" (close)="closePriceDetails()"></dfinance-frontend-item-price-popup>

        <dfinance-frontend-item-details-popup *ngIf="showItemDetails" (close)="closeItemDetails($event)"
            [expireItemDetails]="expireItemDetails"
            (changeExpiry)="onChangeItemExpiry($event)"></dfinance-frontend-item-details-popup>

        <dfinance-frontend-account-popup *ngIf="showTaxPopup" [accountData]="taxPopupObj" popupType="tax"
            (close)="closeTaxPopup()" (savedata)="saveTaxDetailsPopup($event)"></dfinance-frontend-account-popup>

        <dfinance-frontend-account-popup *ngIf="showAdditionalChargesPopup" [accountData]="additonalChargesPopupObj"
            [accountGridDetails]="additonalChargesGridDetails" (savedata)="saveAdditionalCharges($event)"
            (close)="closeAdditionalChargesPopup()"></dfinance-frontend-account-popup>

        <dfinance-frontend-account-popup *ngIf="showItemAdditionalChargesPopup"
            (close)="closeItemAdditionalChargesPopup($event)"></dfinance-frontend-account-popup>

        <dfinance-frontend-account-popup [accountData]="cashPopupObj" *ngIf="showCashPopup"
            [accountGridDetails]="cashPopupGridDetails" (savedata)="saveCashPopup($event)"
            (close)="closeCashPopup()"></dfinance-frontend-account-popup>

        <dfinance-frontend-account-popup [accountData]="cardPopupObj" *ngIf="showCardPopup"
            [accountGridDetails]="cardPopupGridDetails" (savedata)="saveCardPopup($event)"
            (close)="closeCardPopup()"></dfinance-frontend-account-popup>

        <dfinance-frontend-chequepopup [accountData]="chequePopupObj" [bankpopupData]="bankPopupObj"
            *ngIf="showChequePopup" [accountGridDetails]="chequePopupGridDetails" (savedata)="saveChequePopup($event)"
            (close)="closeChequePopup()"></dfinance-frontend-chequepopup>
        <!-- popup for advance amount  -->
        <dfinance-frontend-advance-popup *ngIf="showAdvanceDetails" [advanceData]="advanceAmountObj"
            (close)="closeAdvancePopup($event)" [payAmount]="advancePayableAmount"></dfinance-frontend-advance-popup>

        <div *ngIf="showDeletePopup" class="deletepopup">
            <div class="popup-content">
                <span class="close" (click)="closeDeletePopup()">&times;</span>
                <h2>Confirm Deletion</h2>
                <p>Are you sure you want to delete this entry?</p>
                <input type="text" class="form-control" id="deleteReason" placeholder="Reason for deletion"
                    #reasonInput>
                <div class="popup-actions">
                    <button class="btn btn-primary" (click)="confirmDelete()">OK</button>
                    <button class="btn btn-secondary" (click)="closeDeletePopup()">Cancel</button>
                </div>
            </div>
        </div>

        <div *ngIf="showCancelPopup" class="deletepopup">
            <div class="popup-content">
                <span class="close" (click)="closeCancelPopup()">&times;</span>
                <h2>Confirm Cancel</h2>
                <p>Are you sure you want to cancel this entry?</p>
                <input type="text" class="form-control" id="deleteReason" placeholder="Reason for cancel"
                    [(ngModel)]="cancelReason">
                <div class="popup-actions">
                    <button class="btn btn-primary" (click)="confirmCancel()">OK</button>
                    <button class="btn btn-secondary" (click)="closeCancelPopup()">Cancel</button>
                </div>
            </div>
        </div>

        <dfinance-frontend-remarks-popup *ngIf="showRemarksPopup" [remarks]="selectedItemRemarks"
            (close)="closeRemarksPopup()"></dfinance-frontend-remarks-popup>
        <dfinance-frontend-itemrates-popup *ngIf="showItemRatePopup" [itemRateArr]="prevTransactionData"
            [itemname]="itemRateItemName" (close)="closeItemRatePopup()"></dfinance-frontend-itemrates-popup>
        <dfinance-frontend-relateditempopup *ngIf="showItemSearchPopup" [itemname]="itemSearchName"
            [itemCode]="itemSearchCode" [fillItemDataOptions]="itemSearchPopupOptions" (close)="closeItemSearchPopup()"
            (saveRelatedItem)="onSelectRelatedItem($event)">
        </dfinance-frontend-relateditempopup>

        <dfinance-frontend-pricecategorypopup *ngIf="showPriceCategoryPopup" [priceCatArr]="priceCategoryOptions"
            (close)="closePriceCategoryPopup()" (savePriceCategory)="onSelectPriceCategory($event)">
        </dfinance-frontend-pricecategorypopup>

    </div>